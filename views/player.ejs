<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= titulo %></title>

    <% 
       // Gera URL de Proxy para o Rave
       const proxyUrl = `https://${process.env.VERCEL_URL || 'seusite.vercel.app'}/video-redirect?url=${encodeURIComponent(video)}`;
    %>

    <meta property="og:title" content="<%= titulo %>">
    <meta property="og:site_name" content="Cine Rave">
    <meta property="og:description" content="Assista agora.">
    <meta property="og:image" content="<%= capa %>">
    <meta property="og:type" content="video.movie">
    
    <meta property="og:video" content="<%= proxyUrl %>">
    <meta property="og:video:url" content="<%= proxyUrl %>">
    <meta property="og:video:secure_url" content="<%= proxyUrl %>">
    <meta property="og:video:type" content="video/mp4">
    <meta property="og:video:width" content="1280">
    <meta property="og:video:height" content="720">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoObject",
      "name": "<%= titulo %>",
      "description": "Filme no Cine Rave",
      "thumbnailUrl": "<%= capa %>",
      "uploadDate": "2024-01-01T00:00:00+00:00",
      "contentUrl": "<%= video %>",
      "embedUrl": "<%= proxyUrl %>"
    }
    </script>

    <style>
        body { margin: 0; background: #000; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .player-wrapper { flex: 1; display: flex; align-items: center; justify-content: center; }
        video { width: 100%; height: 100%; object-fit: contain; }
        .top-bar { position: absolute; top: 0; left: 0; width: 100%; padding: 20px; z-index: 10; display: flex; gap: 10px; }
        .btn { background: rgba(0,0,0,0.5); color: white; text-decoration: none; padding: 8px 15px; border-radius: 20px; border: 1px solid white; font-family: sans-serif; }
        .btn-rave { background: #E50914; border: none; }
    </style>
</head>
<body>
    <div class="top-bar">
        <a href="/" class="btn">Voltar</a>
        <a href="<%= raveLink %>" class="btn btn-rave">Abrir no Rave</a>
    </div>
    <div class="player-wrapper">
        <video id="vid" controls autoplay playsinline poster="<%= capa %>">
            <source src="<%= video %>" type="video/mp4">
        </video>
    </div>
</body>
</html>